<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Task | OpenGMS</title>

    <script src="/static/js/common/vue.min.js"></script>
    <script src="/static/element-ui/index.js"></script>
    <link rel="icon" type="image/x-icon" href="/static/img/logo/favicon.ico">
    <link rel="stylesheet" href="/static/element-ui/theme-chalk/index.css">
    <!--<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">-->
    <link rel="stylesheet" href="/static/css/base/bootstrap.min.css">
    <link rel="stylesheet" href="/static/css/common/fileinput.min.css">
    <link rel="stylesheet" href="/static/css/common/fileinput-rtl.min.css">
    <link rel="stylesheet" href="/static/css/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/css/base/style.css">
    <link rel="stylesheet" href="/static/css/base/universal.css">
    <!--<link rel="stylesheet" href="/static/css/other/computable-test.css">-->
    <!--<link rel="stylesheet" href="/static/css/other/jquery.gritter.css">-->
    <!--<link rel="stylesheet" href="/static/css/page/logical_model.css">-->
    <link rel="stylesheet" href="../static/css/components/file-manager.css">
    <link rel="stylesheet" href="/static/haha/css/style.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/static/css/common/navbar.css"/>
    <link rel="stylesheet" type="text/css" media="screen" href="/static/css/common/footerResponse.css"/>
    <style>

        .el-button--text {
            color: black;
        }

        input[type=file] {
            display: none;
        }

        .el-icon-loading {
            font-size: 40px;
        }

        .el-loading-spinner .el-loading-text {
            font-size: 20px;
        }

        .el-collapse-item__header{
            font-size:20px;
            font-style: italic;
        }

        .el-input.is-disabled .el-input__inner{
            background-color: #ecf5ff;
            color: #8d8d8d;
            cursor: default;
        }
    </style>
</head>
<body>
<div id="app">
    <div th:replace="fragments/navbar :: unlog"></div>
    <div class="taskMain">
        <el-row type="flex" justify="space-around">
            <el-col :span="5" role="modelIntro" style="min-width: 220px" id="modelSider">
                <div id="introContainer" class="slider scrollbar">
                    <div class="introHeader">
                        <div class="image">
                            <i class="fa fa-database"></i>
                            <!--<img src="/static/haha/img/default.png">-->
                        </div>
                        <div style="margin-left: 8px">
                            <h3 class="model_title"> {{info.modelInfo.name}}</h3>
                            <span>Contributed by <span style="cursor: pointer; font-size: 2rem;"
                                                       @click="goPersonCenter(info.userInfo.compute_model_user_oid)">{{info.userInfo.compute_model_user_name}}</span></span>
                            <br>
                        </div>
                    </div>
                    <div class="btn-list">
                        <el-button plain type="primary" @click="loadData()" :disabled="!info.modelInfo.hasTest"
                                   style="min-width: 120px">
                            Load data
                        </el-button>


                        <el-button plain type="primary" @click="invoke()" style="min-width: 121px">
                            <i class="fa fa-hand-spock-o"></i>&nbsp;Invoke
                        </el-button>

                    </div>
                    <div class="introContent">
                        <h4 class="desc-title">Introduction</h4>
                        <p class="desc">{{info.modelInfo.des}}</p>
                        <br>
                        <span class="model_date">Updated at <span style="font-weight: 600">{{dateFormat(info.modelInfo.date)}}</span></span>
                    </div>
                </div>
            </el-col>
            <el-dialog :visible.sync="loadDataVisible" title="Load Data" >
                <el-button type="primary" @click="loadTest">Load Test Data</el-button>
                <div style="max-height: 400px;overflow-y: auto">
                    <h4>Published example</h4>
                    <el-table
                            ref="exampleDataTable"
                            :data="exampleDataList"
                            tooltip-effect="dark"
                            style="width: 100%"
                            @selection-change="handleSelectionChange">
                        <!--                    <el-table-column-->
                        <!--                            type="selection"-->
                        <!--                            width="60">-->
                        <!--                    </el-table-column>-->
                        <el-table-column
                                type="index"
                                width="40">
                        </el-table-column>
                        <el-table-column
                                prop="userName"
                                label="user"
                                width="120">
                        </el-table-column>
                        <el-table-column
                                prop="runTime"
                                label="creat time"
                                width="170">
                        </el-table-column>
                        <el-table-column
                                label="description"
                                width="270">
                            <template slot-scope="scope">
                                <el-input type="textarea" :value="scope.row.description"
                                          placeholder="description of this task" @click.native="showDescription(scope.row)">

                                </el-input>
                            </template>
                        </el-table-column>
                        <el-table-column
                                width="120">
                            <template slot-scope="scope">
                                <el-button  plain
                                            size="mini"
                                            type="primary"
                                            @click="loadExampleData(scope.row.taskId)">
                                    load data
                                </el-button>
                            </template>
                        </el-table-column>
                    </el-table>
                </div>

                <div slot="footer" class="dialog-footer">
                    <el-button @click="loadDataVisible = false">cancel</el-button>
                </div>

                <el-dialog title="description" :visible.sync="showDescriptionVisible" width="40%" append-to-body style="top:50px;">
                    <el-card style="min-height: 120px">{{taskDescription}}</el-card>
                </el-dialog>

            </el-dialog>
            <div class="colBorder"></div>
            <el-col :span="18" style="margin-left: 8px">
                <div class="content">
                    <div class="_main">
                        <el-row class="_title">
                            <el-row type="flex" align="middle">
                                <i class="fa fa-cogs"></i>
                                <p style="font-size: 18px;margin-bottom: 0;margin-left:10px">Configure Execution</p>

                                <div style="position:absolute;right:0">
                                    <span style="margin-right:10px">Show style:</span>
                                    <el-radio-group v-model="radioStyle">
                                        <el-radio-button id="classic" label="Classic"></el-radio-button>
                                        <el-radio-button id="semantics" label="Semantics"></el-radio-button>
                                        <el-radio-button id="workFlow" label="Work flow"></el-radio-button>
                                    </el-radio-group>
                                </div>
                            </el-row>

                        </el-row>

                        <el-row v-if="radioStyle=='Classic'">
                            <el-row type="flex" class="state-container" v-for="(state,index) in info.modelInfo.states"
                                    :key="index"
                                    justify="start" style="flex-wrap:wrap">
                                <div class="leftContainer">
                                    <div class="modelState">
                                        <p class="state-name"> {{state.name}}</p>
                                        <p class="state-desc"> {{state.desc}}</p>

                                    </div>
                                </div>
                                <div class="dataContainer">
                                    <div class="_params-group">
                                        <el-row v-if="inEventList(state).length!==0" class="_title">Input</el-row>
                                        <div class="_items">
                                            <el-row v-for="(modelInEvent,inEventIndex) in inEventList(state)"
                                                    :key="inEventIndex" class="_item">
                                                <el-row>


                                                    <el-col :span="9" class="_event-desc">

                                                        <span v-if="modelInEvent.data[0].externalId==undefined" class="event-name" :title="modelInEvent.eventName">
                                                            <span
                                                                    v-show="!modelInEvent.optional"
                                                                    style="color:red">*</span>
                                                            {{modelInEvent.eventName}}
                                                        </span>

                                                        <span v-if="modelInEvent.data[0].externalId!=undefined" class="event-name" :title="modelInEvent.eventName">
                                                            <span
                                                                    v-show="!modelInEvent.optional"
                                                                    style="color:red">*</span>
                                                            <a style="text-decoration: underline;" :href="'/repository/template/'+modelInEvent.data[0].externalId.toLowerCase()" target="_blank">{{modelInEvent.eventName}}</a>
                                                        </span>

                                                    </el-col>
                                                    <div v-if="modelInEvent.data[0].nodes==undefined">
                                                        <el-col :span="6" :offset="1">
                                                            <!--:value="modelInEvent.tag"-->
                                                            <el-input class="model-input"
                                                                      :value="modelInEvent.tag==undefined?'':(modelInEvent.tag+'.'+modelInEvent.suffix)"
                                                                      :id="'datainput'+inEventIndex"
                                                                      :disabled="true">
                                                            </el-input>
                                                        </el-col>

                                                        <el-col :span="8">
                                                            <div class="_btn-group">
                                                                <!--<el-button plain round type="primary"-->
                                                                           <!--@click="editParam(modelInEvent)"-->
                                                                           <!--circle>-->
                                                                    <!--<i class="fa fa-edit"></i>-->
                                                                <!--</el-button>-->
                                                                <el-button plain round type="primary"
                                                                           @click="selectFromDataItem(modelInEvent)"
                                                                           circle>
                                                                    <i class="fa fa-th-large"></i>
                                                                </el-button>

                                                                <el-button plain round type="primary"
                                                                           @click="upload(modelInEvent)">
                                                                    <i class="fa fa-cloud-upload"></i>
                                                                </el-button>
                                                                <el-button plain round type="success"
                                                                           @click="checkPersonData(modelInEvent)">
                                                                    <i class="fa fa-folder-open"></i>
                                                                </el-button>

                                                                <el-button plain round type="warning"
                                                                           v-if="modelInEvent.url!=''&&modelInEvent.url!=null"
                                                                           @click="download(modelInEvent)">
                                                                    <i class="fa fa-download"></i>
                                                                </el-button>

                                                            </div>
                                                        </el-col>
                                                    </div>
                                                </el-row>

                                                <el-row>
                                                    <el-table v-if="modelInEvent.children!=undefined"
                                                              :data="modelInEvent.children"
                                                              border
                                                              style="width: 100%">
                                                        <el-table-column
                                                                prop="eventName"
                                                                label="Parameter"
                                                        >
                                                        </el-table-column>
                                                        <el-table-column
                                                                prop="eventDesc"
                                                                label="Description"
                                                        >
                                                        </el-table-column>
                                                        <el-table-column
                                                                label="Type"
                                                        >
                                                            <template slot-scope="scope">
                                                                <el-tag type="info">
                                                                    {{scope.row.eventType}}
                                                                </el-tag>
                                                            </template>
                                                        </el-table-column>
                                                        <el-table-column

                                                                label="Value">
                                                            <template slot-scope="scope">
                                                                <el-input class="model-input"
                                                                          v-model="scope.row.value"
                                                                >
                                                                </el-input>
                                                            </template>
                                                        </el-table-column>
                                                    </el-table>
                                                </el-row>
                                                <el-row>
                                                    <p class="event-desc" :title="modelInEvent.eventDesc">
                                                        {{modelInEvent.eventDesc}}</p>
                                                </el-row>

                                            </el-row>
                                        </div>
                                    </div>

                                    <div class="_params-group">
                                        <el-row v-if="outEventList(state).length!==0" class="_title">Output</el-row>
                                        <div class="_items">
                                            <el-row v-for="(modelOutEvent,outEventIndex) in outEventList(state)"
                                                    :key="outEventIndex" class="_item">
                                                <el-row>
                                                    <el-col :span="9" class="_event-desc">
                                                      <span class="event-name" :title="modelOutEvent.eventName">
                                                        {{modelOutEvent.eventName}}
                                                    </span>
                                                    </el-col>
                                                    <el-col :span="6" :offset="1">
                                                        <el-input class="model-input" :value="modelOutEvent.tag==undefined?'':(modelOutEvent.tag+'.'+modelOutEvent.suffix)"
                                                                  :disabled="true">
                                                        </el-input>
                                                    </el-col>
                                                    <el-col :span="5" v-show="modelOutEvent.url!=null">
                                                        <div class="_btn-group">
                                                            <el-button plain round type="warning"
                                                                       @click="download(modelOutEvent)">
                                                                <i class="fa fa-download"></i>
                                                            </el-button>
                                                        </div>
                                                    </el-col>
                                                </el-row>
                                                <el-row>
                                                    <p class="event-desc" :title="modelOutEvent.eventDesc">
                                                        {{modelOutEvent.eventDesc}}</p>
                                                </el-row>

                                            </el-row>
                                        </div>
                                    </div>
                                </div>

                            </el-row>

                        </el-row>

                        <el-row v-if="radioStyle=='Semantics'" class="state-container">

                            <el-collapse v-model="semanticsActiveStates">
                                <el-collapse-item :title="state.name" :name="index"
                                                  v-for="(state,index) in info.modelInfo.states" :key="index">
                                    <h4 style="font-size: 16px;margin-bottom:20px">{{state.desc}}</h4>

                                    <el-table :data="state.event" :key="Math.random()" style="width: 100%"
                                              row-key="eventId"
                                              border
                                              default-expand-all
                                              :span-method="arraySpanMethod"
                                              :tree-props="{children: 'children', hasChildren: 'hasChildren'}">
                                        <el-table-column
                                                label="Type"
                                                width="140"
                                        style="text-align: center;">
                                            <template slot-scope="scope">
                                                <el-tag
                                                        :type="scope.row.eventType === 'response' ? 'primary' : (scope.row.eventType=== 'noresponse' ? 'success' : 'info')"
                                                        disable-transitions>{{scope.row.eventType === 'response'?'Input':(scope.row.eventType=== 'noresponse' ? 'Output':scope.row.eventType)}}
                                                </el-tag>
                                            </template>
                                        </el-table-column>
                                        <el-table-column

                                                label="Event Name"
                                                width="200">
                                            <template slot-scope="scope">

                                                <span v-if="scope.row.externalId==undefined" :title="scope.row.eventName">
                                                            <span
                                                                    v-if="!scope.row.optional&&scope.row.eventType != 'noresponse'"
                                                                    style="color:red">*</span>
                                                            {{scope.row.eventName}}
                                                        </span>

                                                <span v-if="scope.row.externalId!=undefined" :title="scope.row.eventName">
                                                            <span
                                                                    v-if="!scope.row.optional&&scope.row.eventType != 'noresponse'"
                                                                    style="color:red">*</span>
                                                            <a style="text-decoration: underline;" :href="'/repository/template/'+scope.row.externalId.toLowerCase()" target="_blank">{{scope.row.eventName}}</a>
                                                        </span>
                                            </template>
                                        </el-table-column>
                                        <el-table-column
                                                prop="eventDesc"
                                                label="Description">
                                        </el-table-column>
                                        <el-table-column
                                                label="Value"
                                                width="180">
                                            <template slot-scope="scope">
                                                <el-input class="model-input"
                                                          v-if="scope.row.children==undefined&&scope.row.child!=true"
                                                          :value="scope.row.tag==undefined?'':(scope.row.tag+'.'+scope.row.suffix)"
                                                          :id="'datainput'+scope.row.eventId"
                                                          disabled="false">
                                                </el-input>
                                                <el-input class="model-input"
                                                          v-if="scope.row.children==undefined&&scope.row.child==true"
                                                          v-model="scope.row.value"
                                                          :id="'datainput'+scope.row.eventId">
                                                </el-input>
                                            </template>
                                        </el-table-column>
                                        <el-table-column
                                                label="Operation"
                                                width="280">
                                            <template slot-scope="scope">
                                                <div class="_btn-group" v-if="scope.row.children==undefined">
                                                    <el-button plain round type="primary"
                                                               v-if="scope.row.eventType === 'response' ?true:false"
                                                               @click="selectFromDataItem(scope.row)"
                                                               circle>
                                                        <i class="fa fa-th-large"></i>
                                                    </el-button>
                                                    <el-button plain round type="primary"
                                                               v-if="scope.row.eventType === 'response' ?true:false"
                                                               @click="upload(scope.row)">
                                                        <i class="fa fa-cloud-upload"></i>
                                                    </el-button>
                                                    <el-button plain round type="success"
                                                               v-if="scope.row.eventType === 'response' ?true:false"
                                                               @click="check(scope.row)">
                                                        <i class="fa fa-folder-open"></i>
                                                    </el-button>

                                                    <el-button plain round type="warning"
                                                               v-if="scope.row.url!=''&&scope.row.url!=null"
                                                               @click="download(scope.row)">
                                                        <i class="fa fa-download"></i>
                                                    </el-button>
                                                </div>
                                            </template>
                                        </el-table-column>
                                    </el-table>

                                </el-collapse-item>
                            </el-collapse>
                        </el-row>

                        <el-row v-if="radioStyle=='Work flow'">
                            <div id="ogmsDiagramContainer"></div>
                        </el-row>

                        <!-- <el-tabs v-model="activeTab" tab-position="left">
                            <el-tab-pane v-for="(state,index) in modelInfo.states" :key="index" :label="state.name"
                                :name="state.name">
                                <div class="_state-desc">
                                    {{state.des}}
                                </div>
                                <div class="_params-group">
                                    <el-row v-if="inEventList(state).length!==0" class="_title">Input</el-row>
                                    <div class="_items">
                                        <el-row v-for="(modelInEvent,inEventIndex) in inEventList(state)" :key="inEventIndex"
                                            class="_item">
                                            <el-col :span="16" class="_event-desc"><span v-show="!modelInEvent.isOptional" style="color:red">*</span> {{modelInEvent.name}}

                                                    <br>
                                                    {{modelInEvent.des}}</el-col>
                                            <el-col :span="3" :offset="1">
                                                <el-input :value="modelInEvent.tag" readonly>
                                                </el-input>
                                            </el-col>
                                            <el-col :span="4">
                                                <div class="_btn-group">
                                                    <el-button plain round type="primary" @click="check(modelInEvent)">
                                                        <i class="fa fa-cloud-upload"></i>
                                                    </el-button>
                                                    <el-button plain round type="warning" @click="upload(modelInEvent)">
                                                        <i class="fa fa-download"></i>
                                                    </el-button>
                                                    <el-button plain round type="success" @click="download(modelInEvent)"
                                                        v-if="modelInEvent.singleVSservice">
                                                        <i class="fa fa-area-chart"></i>
                                                    </el-button>
                                                </div>
                                            </el-col>



                                        </el-row>
                                    </div>
                                </div>

                                <div class="_params-group">
                                    <el-row v-if="outEventList(state).length!==0" class="_title">Output</el-row>
                                    <div class="_items">
                                        <el-row v-for="(modelOutEvent,outEventIndex) in outEventList(state)"
                                            :key="outEventIndex" class="_item">
                                            <el-col :span="16" class="_event-desc">{{modelOutEvent.des}}</el-col>
                                        </el-row>
                                    </div>
                                </div>
                            </el-tab-pane>

                        </el-tabs> -->

                        <!--item-->

                        <el-col :span="3" :offset="21" class="_save-btn">
                            <el-button plain type="primary" @click="invoke()">
                                <i class="fa fa-hand-spock-o"></i>&nbsp;Invoke
                            </el-button>
                        </el-col>

                        <el-dialog title="Choose Data" :visible.sync="showUpload" width="30%">
                            <el-upload ref="upload" drag action="/dispatchRequest/upload" :data="uploadData()"
                                       :before-remove="beforeRemove" :file-list="fileList"
                                       :on-success="onSuccess">
                                <el-button slot="trigger" size="small" type="primary">Choose File</el-button>
                            </el-upload>
                        </el-dialog>

                        <el-dialog title="Personal Center Data" :visible.sync="showDataChose" width="70%">
                            <div class="researchTitle">
                                <ul class="researchMenu flexRowContainer">
                                    <li :class="{researchMenuChoosed:dataChosenIndex==1}" style="cursor: pointer;"
                                        @click="myDataClick(1)">My Data
                                    </li>
                                    <li :class="{researchMenuChoosed:dataChosenIndex==2}" style="cursor: pointer;"
                                        @click="outputDataClick(2)">Output Data
                                    </li>
                                </ul>
                                <el-col :span="9" style="float: right;font-weight: 500" >
                                <el-input id="searchinput"
                                          placeholder="input keywords, press enter to search "
                                          v-model="searchcontent"
                                          @keyup.enter.native="keywordsSearch()" size="mini"
                                >
                                    <el-button slot="append" icon="el-icon-search" @click="keywordsSearch()"></el-button>

                                </el-input>
                                </el-col>
                            </div>

                            <div class="col-md-12 col-sm-12 showHidden" :class="{showActive:dataChosenIndex==1}" style="height: 100%">
                                <div class="panel panel-success" style="border: none;height: 100%;overflow: hidden">
                                    <!--<div class="panel-heading">-->
                                    <!--<h3 class="panel-title">-->
                                    <!--Manager my data below.-->
                                    <!--</h3>-->
                                    <!--</div>-->
                                    <div style="height: 100%">
                                        <div class="infoBar" role="alert" id="outputDataChosen">
                                            <div>
                                                <span><i class="el-icon-document"></i>&nbsp&nbsp You have selected:</span>&nbsp;&nbsp;&nbsp;
                                                <span v-if="downloadDataSetName.length==0">no data..</span>
                                                <span v-for="item in downloadDataSetName">{{item.name}}<span v-if="item.package==false">.{{item.suffix}}</span>, </span>
                                            </div>
                                            <div class="flexRowContainer">
                                            </div>

                                        </div>
                                        <el-row style="height: calc(100% - 100px);">
                                            <el-col :span="24" class="fileTemplate" style="height: 100%">
                                                <el-card style="height:320px;overflow-y:auto;width:100%" id="browsercont1"
                                                         v-loading="managerloading" :style="{display:fileSpaceIndex==1?'block':'none'}" >
                                                    <div style="width: 100%;height: 20px;margin-left: -5px;display: flex;justify-content: space-between;align-items: center">
                                                        <div class="showPathContainer">
                                                            <div class="squareButton" id="backFatherBtn" @click="backToFather">
                                                                <i class="fa fa-arrow-left" style="margin-right:2px "></i>
                                                            </div>
                                                            <div class="squareButton" id="refreshPackageBtn" @click="refreshPackage($event,1)">
                                                                <i class="fa fa-refresh" style="font-weight: 600"></i>
                                                            </div>
                                                            <div class="showPathContainer" style="margin-left: 10px">
                                                                <div>path</div>:
                                                                <div v-for="(path,index) in pathShown" :style="{color:index==pathShown.length-1?'#222222':'#666666'}"> /{{path.label}} </div>
                                                            </div>
                                                        </div>

                                                        <p style="font-style: italic;color: #999999;float: right;margin: 0">
                                                            Left or right click can call out some function</p>
                                                    </div>
                                                    <div v-if="myFileShown.length!=0" :title="showtitle(item)" class="el-card dataitemisol" shadow="never"
                                                         :id="generateId(key)" :class="{clickdataitem:downloadDataSet.indexOf(item)>-1}"
                                                         v-for="(item,key) in myFileShown"
                                                         :key="key"

                                                         @mouseover="addDataClass($event,item)"
                                                         @mouseout="removeClass($event,item)">
                                                        <el-row style="height: 80%" @dblclick.native="getPackageContent($event,item,key)">
                                                            <el-col :span="5">&nbsp
                                                                <div class="squareButtonMini flexCenter" style="margin: 4px;float: inherit;cursor: pointer" @click="singleClick($event,item)"
                                                                     v-if="item.package==false">
                                                                    <i style="font-size: 16px;color:#1b7cde" :style="{display:(downloadDataSet.indexOf(item)>-1)?'block':'none'}" class="fa fa-check"></i>
                                                                </div>
                                                            </el-col>
                                                            <el-col :span="15" style="height: 100%;" >
                                                                <img class="fileImg" :src="getImg(item)" onerror=src="/static/img/filebrowser/unknow.svg" style="height: 100%;width:100%;cursor: pointer">
                                                            </el-col>
                                                            <el-col :span="4">&nbsp
                                                                <div v-if="item.upload==true" style="margin-right: 5px;margin-top: 4px;float: right">
                                                                    <i class="fa fa-user-circle-o" style="font-size: 16px;color:#1b7cde"></i>
                                                                </div>
                                                            </el-col>
                                                        </el-row>
                                                        <el-row type="flex" justify="center" v-if="item" class="fileName"
                                                                @click.native="getPackageContent($event,item,key)" style="cursor: pointer">
                                                            <p style="text-align: center;word-break: break-all;" v-if="item">{{item.label}}</p>
                                                            <p v-if="item.suffix">.</p>
                                                            <p v-if="item.suffix">{{item.suffix}}</p>
                                                        </el-row>

                                                        <!--menu item -->
                                                    </div>
                                                </el-card>

                                                <el-card style="height: 100%;overflow-y:auto;width:100%" id="browsercont"
                                                         v-loading="managerloading" :style="{display:fileSpaceIndex==2?'block':'none'}">
                                                    <div :title="showtitle(item)" class="el-card dataitemisol" shadow="never"
                                                         :id="generateId(key)"
                                                         v-for="(item,key) in databrowser"
                                                         :key="key"
                                                         @click="getid($event,item)"
                                                         @mouseover="addDataClass($event,item)"
                                                         @mouseout="removeClass($event,item)">
                                                        <el-row style="height: 80%">
                                                            <el-col :span="6">&nbsp</el-col>
                                                            <el-col :span="14" style="height: 100%;"><img :src="getImg(item)"
                                                                                                          style="height: 100%;width:100%">
                                                            </el-col>
                                                            <el-col :span="4">&nbsp</el-col>
                                                        </el-row>
                                                        <el-row type="flex" justify="center">
                                                            <p> {{item.fileName}}.{{item.suffix}} </p>
                                                        </el-row>
                                                        <!--menu item -->
                                                    </div>
                                                </el-card>

                                            </el-col>
                                        </el-row>
                                        <!--<el-button icon="el-icon-sold-out" class="dall" @click="dall()">download selected all files-->
                                        <!--</el-button>-->

                                    </div>

                                </div>
                            </div>

                            <div class="col-md-12 col-sm-12 showHidden" :class="{showActive:dataChosenIndex==2}">
                                <div class="panel panel-success" style="border: none;height: 650px;overflow: hidden">
                                    <div>
                                        <!--                            数据文件夹的内容-->
                                        <el-row class="showHidden" type="flex" justify="center"
                                                :class="{showActive:detailsIndex==1}">
                                            <el-card style="height: 560px;overflow-y:auto;width:100%" id="browsercont"
                                                     v-loading="managerloading">

                                                <!--</el-row>-->

                                                <div :title="showtitle(item)" class="el-card dataitemisol"
                                                     shadow="never"
                                                     :id="generateId(key)"
                                                     v-for="(item,key) in userTaskInfo"
                                                     :key="key"
                                                     @click="getid($event,item)"
                                                     @mouseover="addDataClass($event,item)"
                                                     @mouseout="removeClass($event,item)"
                                                     @click.right="openWzhRightMenu($event)">

                                                    <el-row type="flex" justify="center">
                                                        <h4>File Package</h4>
                                                    </el-row>
                                                    <el-row type="flex" justify="center"
                                                            style="align-items: center;flex-direction: column">
                                                        <p style="text-align: center">{{item.modelName}}</p>
                                                        <p>@{{dateFormat(item.createTime)}} </p>


                                                    </el-row>

                                                    <!--menu item -->

                                                </div>

                                            </el-card>
                                            <ul class="wzhRightMenu" ref="browsermenu">
                                                <li @click="download_data_dataManager()" type="text">download
                                                </li>
                                                <li @click="delete_data_dataManager()" type="text">delete
                                                </li>
                                                <li @click="share" type="text">share</li>
                                                <li @click="relatedModels_dataManager()" type="text">relatedModels
                                                </li>
                                            </ul>
                                        </el-row>
                                        <!--                            用户跑完模型的数据文件夹-->
                                        <el-row class="showHidden" type="flex" justify="center"
                                                :class="{showActive:detailsIndex==2}">
                                            <el-card style="height: 560px;overflow-y:auto;width:100%" id="outputData"
                                                     v-loading="managerloading">
                                                <div class="contentFlexContainer">
                                                    <div class="squareButton" @click="backToPackage">
                                                        <i class="fa fa-arrow-left" style="margin-right:2px "></i>
                                                    </div>
                                                    <div class="modelTitleContainer" style="text-align: center;">
                                                        <h4>{{packageContent.computableName}}</h4>
                                                    </div>
                                                </div>
                                                <!--  input-->
                                                <div class="containerWithColor"
                                                     style=" background-color: rgba(227, 252, 255, 0.31);border-color: #289ec2">
                                                    <div class="subTitle" style="with:100%;">
                                                        <h4 style="font-style: italic;color:#289ec2 ;">Input</h4>
                                                    </div>
                                                    <el-row type="flex" justify="space-around">
                                                        <div :title="showtitle(item)" class="el-card dataitemisol"
                                                             shadow="never"
                                                             :id="generateId(key)"
                                                             v-for="(item,key) in packageContent.inputs"
                                                             :key="key"
                                                             @click="getid($event,item)"
                                                             @mouseover="addDataClass($event,item)"
                                                             @mouseout="removeClass($event,item)"
                                                             @click.right="rightMenu($event)">

                                                            <el-row type="flex" justify="center">
                                                                <h4>File</h4>
                                                            </el-row>
                                                            <el-row type="flex" justify="center"
                                                                    style="align-items: center;flex-direction: column">
                                                                <p style="text-align: center">{{item.tag}}</p>


                                                            </el-row>
                                                        </div>
                                                    </el-row>
                                                </div>

                                                <!-- output-->
                                                <div class="containerWithColor"
                                                     style=" background-color: #acff9c21;border-color: #71d913">
                                                    <div class="subTitle" style="with:100%;">
                                                        <h4 style="font-style: italic;color:#71d913 ;">Output</h4>
                                                    </div>
                                                    <el-row type="flex" justify="space-around">
                                                        <div :title="showtitle(item)" class="el-card dataitemisol"
                                                             shadow="never"
                                                             :id="generateId(key)"
                                                             v-for="(item,key) in packageContent.outputs"
                                                             :key="key"
                                                             @click="getid($event,item)"
                                                             @mouseover="addDataClass($event,item)"
                                                             @mouseout="removeClass($event,item)"
                                                             @click.right="openWzhRightMenu($event,item)">

                                                            <el-row type="flex" justify="center">
                                                                <h4>File</h4>
                                                            </el-row>
                                                            <el-row type="flex" justify="center"
                                                                    style="align-items: center;flex-direction: column">
                                                                <p style="text-align: center">{{item.tag}}</p>
                                                            </el-row>

                                                            <!--menu item -->
                                                        </div>
                                                    </el-row>
                                                </div>
                                            </el-card>
                                        </el-row>

                                    </div>
                                </div>
                            </div>

                            <span slot="footer" class="dialog-footer">
                                <el-button type="primary" @click="selectDataFromPersonal">Confirm</el-button>
                                <el-button @click="showDataChose = false">Cancel</el-button>
                            </span>
                        </el-dialog>
                        <!--                                 dialog end                       -->

                        <el-dialog top="40px" :width="paramType=='internal'?'70%':'90%'" title="Parameter Detail" :visible.sync="paramDialogVisible">
                            <el-table v-if="paramType=='internal'"
                                    :data="paramTable"
                                    border
                                    style="width: 100%">
                                <el-table-column
                                        prop="text"
                                        label="Parameter"
                                        >
                                </el-table-column>
                                <el-table-column
                                        prop="desc"
                                        label="Description"
                                        >
                                </el-table-column>
                                <el-table-column
                                        prop="dataType"
                                        label="Type"
                                        >
                                </el-table-column>
                                <el-table-column

                                        label="Value">
                                    <template slot-scope="scope">
                                        <el-input class="model-input"
                                                  v-model="scope.row.value"
                                        >
                                        </el-input>
                                    </template>
                                </el-table-column>
                            </el-table>
                            <iframe v-if="paramType=='external'" :src="externalUrl" style="width:100%;min-height: 700px;"></iframe>
                            <span v-if="paramType=='internal'" slot="footer" class="dialog-footer">
                                <el-button @click="paramDialogVisible=false">Cancel</el-button>
                                <el-button type="primary" @click="generateParamFile()">OK</el-button>
                            </span>
                        </el-dialog>

                        <el-dialog top="40px" width="70%" title="select from data item" :visible.sync="dataItemVisible">
                            <el-card>
                                <el-col :span="6" style="overflow-y: scroll;height: 550px;">
                                    <el-collapse>

                                        <el-collapse-item v-for="(item,index) in categoryTree"
                                                          :title=item.key :name=index :key="index">

                                            <el-button class="taskDataCate" v-for="it in item.value" type="text"
                                                       @click="chooseCate(it,$event)">{{it.category}}
                                            </el-button>

                                        </el-collapse-item>
                                    </el-collapse>
                                </el-col>
                                <el-col :span="18" class="col-md-9 col-sm-8">
                                    <el-input placeholder="Please enter name..." v-model="dataItemSearchText"
                                              class="input-with-select">
                                        <el-button slot="append" icon="el-icon-search"
                                                   @click="searchDataItem()"></el-button>
                                    </el-input>
                                    <el-table
                                            :data="pageOption.searchResult"
                                            style="margin-top:17px;"
                                    >
                                        <el-table-column type="expand">
                                            <template slot-scope="props">
                                                <el-card v-for="item,key in props.row.dataList"
                                                         :title="item.name" class="dataitemisol" shadow="never"
                                                         :id="item.url"
                                                         :key="key" @click.native="clickData(item,$event)">

                                                    <el-row>
                                                        <el-col :span="6">&nbsp</el-col>
                                                        <el-col :span="12"><img
                                                                :src="'/static/img/filebrowser/'+item.suffix+'.svg'"
                                                                style="height: 60%;width:100%"></el-col>
                                                        <el-col :span="6">&nbsp</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="2">&nbsp</el-col>
                                                        <el-col :span="20">

                                                            <p style="text-align: center;word-break: break-all;"
                                                            >{{item.name+(item.suffix!='unknow'?item.suffix:'')}}</p>
                                                        </el-col>
                                                        <el-col :span="2">&nbsp</el-col>

                                                    </el-row>

                                                    <!--menu item -->


                                                </el-card>
                                            </template>
                                        </el-table-column>
                                        <el-table-column
                                                label="Name">
                                            <template slot-scope="props">
                                                <a :href="'/dataItem/'+props.row.id"
                                                   target="_blank">{{props.row.name}}</a>
                                            </template>
                                        </el-table-column>
                                        <el-table-column
                                                label="Contributor"
                                        >
                                            <template slot-scope="scope">
                                                <a :href="'/user/'+scope.row.author.oid" target="_blank">{{scope.row.author.name}}</a>
                                            </template>
                                        </el-table-column>
                                        <el-table-column fixed="right" label="Operation" width="100">
                                            <template slot-scope="scope">
                                                <el-button
                                                        size="mini"
                                                        @click="handleView(scope.$index, scope.row)">View
                                                </el-button>

                                            </template>
                                        </el-table-column>
                                    </el-table>
                                    <el-pagination style="text-align: center;margin-top:20px"
                                                   @current-change="handlePageChange"
                                                   :current-page="pageOption.page"
                                                   layout="total, prev, pager, next, jumper"
                                                   :page-size="5"
                                                   :total="pageOption.total">
                                    </el-pagination>
                                </el-col>
                            </el-card>

                            <span slot="footer" class="dialog-footer">
                                <el-button @click="downloadData()">Download</el-button>
                                <el-button type="primary" @click="confirmData()">Confirm</el-button>
                            </span>
                        </el-dialog>
                    </div>
                </div>
            </el-col>
        </el-row>

    </div>
    <div th:replace="fragments/footer :: footer"></div>
</div>
</body>


<script>
    mxBasePath = "/static/js/mxGraph";
</script>

<script src="/static/js/mxGraph/js/mxClient.js"></script>
<script src="/static/js/mxGraph/js/ogmsDiagram.js"></script>

<!--<script src="/static/js/common/knockout-3.4.2.js"></script>-->
<script src="/static/js/common/jquery-3.3.1.min.js"></script>
<script src="/static/js/common/loadUser.js"></script>

<!--<script src="/static/js/common/jquery.gritter.min.js"></script>-->
<!--<script src="/static/js/common/lodash.js"></script>-->
<script src="/static/js/common/bootstrap.js"></script>
<script src="/static/js/common/bootstrap-treeview.js"></script>
<!--<script src="/static/js/common/bootstrap-treeview.js"></script>-->

<!--<script type="text/javascript">-->
<!--mxBasePath = '/static/MxGraph/'-->
<!--</script>-->
<!--<script type="text/javascript" src="/static/MxGraph/js/mxClient.js"></script>-->
<!--<script type="text/javascript" src="/static/js/common/computableEditorTest.js"></script>-->
<script src="/static/js/common/fileinput.js"></script>
<script src="/static/js/common/loadUser.js"></script>
<script src="/static/js/common/axios.min.js"></script>
<script type="text/javascript" src="/static/js/common/jquery.tag-editor.js"></script>
<script src="/static/js/common/bootstrap-tagsinput.js"></script>
<!--<script src="https://unpkg.com/element-ui/lib/index.js"></script>-->
<script src="/static/js/page/task.js"></script>
<script src="/static/element-ui/umd/locale/en.js"></script>
<script src="/static/js/common/navbar.js"></script>


</html>